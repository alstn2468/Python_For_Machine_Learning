
Chapter 5<br/>
< Pandas #2 >
===============================

[[실행 코드]](https://github.com/alstn2468/Python_For_Machine_Learning/blob/master/Chapter.5/3/3.ipynb)


### Groupby
- SQL groupby 명령어와 같음
- split -> apply -> combine<br/>
과정을 거쳐 연산


```python
import pandas as pd

ipl_data = {'Team': ['Riders', 'Riders', 'Devils', 'Devils', 'Kings',
                     'kings', 'Kings', 'Kings', 'Riders', 'Royals', 'Royals', 'Riders'],
            'Rank': [1, 2, 2, 3, 3, 4 ,1 ,1, 2 , 4, 1, 2],
            'Year': [2014, 2015, 2014, 2015, 2014, 2015, 2016, 2017, 2016, 2014, 2015, 2017],
            'Points':[876, 789, 863, 673, 741, 812, 756, 788, 694, 701, 804, 690]}

df = pd.DataFrame(ipl_data)
df
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Points</th>
      <th>Rank</th>
      <th>Team</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>876</td>
      <td>1</td>
      <td>Riders</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>1</th>
      <td>789</td>
      <td>2</td>
      <td>Riders</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>2</th>
      <td>863</td>
      <td>2</td>
      <td>Devils</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>3</th>
      <td>673</td>
      <td>3</td>
      <td>Devils</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4</th>
      <td>741</td>
      <td>3</td>
      <td>Kings</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>5</th>
      <td>812</td>
      <td>4</td>
      <td>kings</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>6</th>
      <td>756</td>
      <td>1</td>
      <td>Kings</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>7</th>
      <td>788</td>
      <td>1</td>
      <td>Kings</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>8</th>
      <td>694</td>
      <td>2</td>
      <td>Riders</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>9</th>
      <td>701</td>
      <td>4</td>
      <td>Royals</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>10</th>
      <td>804</td>
      <td>1</td>
      <td>Royals</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>11</th>
      <td>690</td>
      <td>2</td>
      <td>Riders</td>
      <td>2017</td>
    </tr>
  </tbody>
</table>
</div>



- 묶음의 기준이 되는 컬럼 : Team
- 적용받는 컬럼 : Points
- 적용받는 연산 : sum()
- 결과 : Team을 기준으로 Points를 Sum


```python
df.groupby("Team")["Points"].sum()
```




    Team
    Devils    1536
    Kings     2285
    Riders    3049
    Royals    1505
    kings      812
    Name: Points, dtype: int64



- 1개 이상의 column을 묶을 수 있다.


```python
df.groupby(['Team', 'Year'])['Points'].sum()
```




    Team    Year
    Devils  2014    863
            2015    673
    Kings   2014    741
            2016    756
            2017    788
    Riders  2014    876
            2015    789
            2016    694
            2017    690
    Royals  2014    701
            2015    804
    kings   2015    812
    Name: Points, dtype: int64



### Hierarchical index
- Groupby 명령의 결과물은 DataFrame
- 2개의 column으로 groupby를 할 경우, index가 2개 생성


```python
h_index = df.groupby(["Team", "Year"])["Points"].sum()
h_index
```




    Team    Year
    Devils  2014    863
            2015    673
    Kings   2014    741
            2016    756
            2017    788
    Riders  2014    876
            2015    789
            2016    694
            2017    690
    Royals  2014    701
            2015    804
    kings   2015    812
    Name: Points, dtype: int64




```python
h_index.index
```




    MultiIndex(levels=[['Devils', 'Kings', 'Riders', 'Royals', 'kings'], [2014, 2015, 2016, 2017]],
               labels=[[0, 0, 1, 1, 1, 2, 2, 2, 2, 3, 3, 4], [0, 1, 0, 2, 3, 0, 1, 2, 3, 0, 1, 1]],
               names=['Team', 'Year'])




```python
h_index['Devils' : 'Kings']
```




    Team    Year
    Devils  2014    863
            2015    673
    Kings   2014    741
            2016    756
            2017    788
    Name: Points, dtype: int64



#### Hierarchical index - unstack()
- Group으로 묶여진 데이터를 matrix형태로 전환


```python
h_index.unstack()
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Year</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
    <tr>
      <th>Team</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Devils</th>
      <td>863.0</td>
      <td>673.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Kings</th>
      <td>741.0</td>
      <td>NaN</td>
      <td>756.0</td>
      <td>788.0</td>
    </tr>
    <tr>
      <th>Riders</th>
      <td>876.0</td>
      <td>789.0</td>
      <td>694.0</td>
      <td>690.0</td>
    </tr>
    <tr>
      <th>Royals</th>
      <td>701.0</td>
      <td>804.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>kings</th>
      <td>NaN</td>
      <td>812.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



### Hierarchical index  - swaplevel
- index level을 변경할 수 있다.


```python
h_index.swaplevel()
```




    Year  Team  
    2014  Devils    863
    2015  Devils    673
    2014  Kings     741
    2016  Kings     756
    2017  Kings     788
    2014  Riders    876
    2015  Riders    789
    2016  Riders    694
    2017  Riders    690
    2014  Royals    701
    2015  Royals    804
          kings     812
    Name: Points, dtype: int64




```python
h_index.swaplevel().sortlevel(0)
```

    /anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:1: FutureWarning: sortlevel is deprecated, use sort_index(level=...)
      """Entry point for launching an IPython kernel.





    Year  Team  
    2014  Devils    863
          Kings     741
          Riders    876
          Royals    701
    2015  Devils    673
          Riders    789
          Royals    804
          kings     812
    2016  Kings     756
          Riders    694
    2017  Kings     788
          Riders    690
    Name: Points, dtype: int64



### Hierarchical index - operations
- index level을 기준으로 기본 연산 수행 가능


```python
h_index.sum(level = 0)
```




    Team
    Devils    1536
    Kings     2285
    Riders    3049
    Royals    1505
    kings      812
    Name: Points, dtype: int64




```python
h_index.sum(level = 1)
```




    Year
    2014    3181
    2015    3078
    2016    1450
    2017    1478
    Name: Points, dtype: int64



### Groupby - grouped
- Groupby에 의해 Split된 상태를 추출 가능
- Tuple 형태로 그룹의 key값, value값이 추출


```python
grouped = df.groupby('Team')

for name, group in grouped :
    print(name)
    print(type(name))
    print(group)
    print(type(group))
```

    Devils
    <class 'str'>
       Points  Rank    Team  Year
    2     863     2  Devils  2014
    3     673     3  Devils  2015
    <class 'pandas.core.frame.DataFrame'>
    Kings
    <class 'str'>
       Points  Rank   Team  Year
    4     741     3  Kings  2014
    6     756     1  Kings  2016
    7     788     1  Kings  2017
    <class 'pandas.core.frame.DataFrame'>
    Riders
    <class 'str'>
        Points  Rank    Team  Year
    0      876     1  Riders  2014
    1      789     2  Riders  2015
    8      694     2  Riders  2016
    11     690     2  Riders  2017
    <class 'pandas.core.frame.DataFrame'>
    Royals
    <class 'str'>
        Points  Rank    Team  Year
    9      701     4  Royals  2014
    10     804     1  Royals  2015
    <class 'pandas.core.frame.DataFrame'>
    kings
    <class 'str'>
       Points  Rank   Team  Year
    5     812     4  kings  2015
    <class 'pandas.core.frame.DataFrame'>


- 특정 key값을 가진 그룹의 정보만 추출 가능


```python
grouped.get_group('Devils')
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Points</th>
      <th>Rank</th>
      <th>Team</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>863</td>
      <td>2</td>
      <td>Devils</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>3</th>
      <td>673</td>
      <td>3</td>
      <td>Devils</td>
      <td>2015</td>
    </tr>
  </tbody>
</table>
</div>



- 추출된 group 정보에는 세 가지 유형의 apply가 가능
- Aggregation : 요약된 통계정보 추출
- Transformation : 해당 정보를 변환
- Filtration : 특정 정보를 제거하여 보여주는 필터링 기능

### Groupby - aggregation


```python
grouped.agg(sum)
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Points</th>
      <th>Rank</th>
      <th>Year</th>
    </tr>
    <tr>
      <th>Team</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Devils</th>
      <td>1536</td>
      <td>5</td>
      <td>4029</td>
    </tr>
    <tr>
      <th>Kings</th>
      <td>2285</td>
      <td>5</td>
      <td>6047</td>
    </tr>
    <tr>
      <th>Riders</th>
      <td>3049</td>
      <td>7</td>
      <td>8062</td>
    </tr>
    <tr>
      <th>Royals</th>
      <td>1505</td>
      <td>5</td>
      <td>4029</td>
    </tr>
    <tr>
      <th>kings</th>
      <td>812</td>
      <td>4</td>
      <td>2015</td>
    </tr>
  </tbody>
</table>
</div>




```python
import numpy as np
grouped.agg(np.mean)
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Points</th>
      <th>Rank</th>
      <th>Year</th>
    </tr>
    <tr>
      <th>Team</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Devils</th>
      <td>768.000000</td>
      <td>2.500000</td>
      <td>2014.500000</td>
    </tr>
    <tr>
      <th>Kings</th>
      <td>761.666667</td>
      <td>1.666667</td>
      <td>2015.666667</td>
    </tr>
    <tr>
      <th>Riders</th>
      <td>762.250000</td>
      <td>1.750000</td>
      <td>2015.500000</td>
    </tr>
    <tr>
      <th>Royals</th>
      <td>752.500000</td>
      <td>2.500000</td>
      <td>2014.500000</td>
    </tr>
    <tr>
      <th>kings</th>
      <td>812.000000</td>
      <td>4.000000</td>
      <td>2015.000000</td>
    </tr>
  </tbody>
</table>
</div>



- 특정 column에 여러개의 function을 적용 가능


```python
grouped['Points'].agg([np.sum, np.mean, np.std])
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>Team</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Devils</th>
      <td>1536</td>
      <td>768.000000</td>
      <td>134.350288</td>
    </tr>
    <tr>
      <th>Kings</th>
      <td>2285</td>
      <td>761.666667</td>
      <td>24.006943</td>
    </tr>
    <tr>
      <th>Riders</th>
      <td>3049</td>
      <td>762.250000</td>
      <td>88.567771</td>
    </tr>
    <tr>
      <th>Royals</th>
      <td>1505</td>
      <td>752.500000</td>
      <td>72.831998</td>
    </tr>
    <tr>
      <th>kings</th>
      <td>812</td>
      <td>812.000000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



### Groupby - transformation
- Aggregation과 달리 key값 별로 요약된 정보가 아니다.
- 개별 데이터의 변환을 지원


```python
df
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Points</th>
      <th>Rank</th>
      <th>Team</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>876</td>
      <td>1</td>
      <td>Riders</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>1</th>
      <td>789</td>
      <td>2</td>
      <td>Riders</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>2</th>
      <td>863</td>
      <td>2</td>
      <td>Devils</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>3</th>
      <td>673</td>
      <td>3</td>
      <td>Devils</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4</th>
      <td>741</td>
      <td>3</td>
      <td>Kings</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>5</th>
      <td>812</td>
      <td>4</td>
      <td>kings</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>6</th>
      <td>756</td>
      <td>1</td>
      <td>Kings</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>7</th>
      <td>788</td>
      <td>1</td>
      <td>Kings</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>8</th>
      <td>694</td>
      <td>2</td>
      <td>Riders</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>9</th>
      <td>701</td>
      <td>4</td>
      <td>Royals</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>10</th>
      <td>804</td>
      <td>1</td>
      <td>Royals</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>11</th>
      <td>690</td>
      <td>2</td>
      <td>Riders</td>
      <td>2017</td>
    </tr>
  </tbody>
</table>
</div>




```python
score = lambda x : (x)
grouped.transform(score)
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Points</th>
      <th>Rank</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>876</td>
      <td>1</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>1</th>
      <td>789</td>
      <td>2</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>2</th>
      <td>863</td>
      <td>2</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>3</th>
      <td>673</td>
      <td>3</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4</th>
      <td>741</td>
      <td>3</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>5</th>
      <td>812</td>
      <td>4</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>6</th>
      <td>756</td>
      <td>1</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>7</th>
      <td>788</td>
      <td>1</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>8</th>
      <td>694</td>
      <td>2</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>9</th>
      <td>701</td>
      <td>4</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>10</th>
      <td>804</td>
      <td>1</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>11</th>
      <td>690</td>
      <td>2</td>
      <td>2017</td>
    </tr>
  </tbody>
</table>
</div>



- 단 max나 min처럼 Series 데이터에 적용되는<br/>
데이터들은 Key값을 기준으로 Grouped된 데이터 기준


```python
score = lambda x : (x.max())
grouped.transform(score)
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Points</th>
      <th>Rank</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>876</td>
      <td>2</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>1</th>
      <td>876</td>
      <td>2</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>2</th>
      <td>863</td>
      <td>3</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>3</th>
      <td>863</td>
      <td>3</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4</th>
      <td>788</td>
      <td>3</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>5</th>
      <td>812</td>
      <td>4</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>6</th>
      <td>788</td>
      <td>3</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>7</th>
      <td>788</td>
      <td>3</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>8</th>
      <td>876</td>
      <td>2</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>9</th>
      <td>804</td>
      <td>4</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>10</th>
      <td>804</td>
      <td>4</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>11</th>
      <td>876</td>
      <td>2</td>
      <td>2017</td>
    </tr>
  </tbody>
</table>
</div>




```python
score = lambda x : (x - x.mean()) / x.std()
grouped.transform(score)
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Points</th>
      <th>Rank</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.284327</td>
      <td>-1.500000</td>
      <td>-1.161895</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.302029</td>
      <td>0.500000</td>
      <td>-0.387298</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.707107</td>
      <td>-0.707107</td>
      <td>-0.707107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.707107</td>
      <td>0.707107</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.860862</td>
      <td>1.154701</td>
      <td>-1.091089</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.236043</td>
      <td>-0.577350</td>
      <td>0.218218</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.096905</td>
      <td>-0.577350</td>
      <td>0.872872</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.770596</td>
      <td>0.500000</td>
      <td>0.387298</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-0.707107</td>
      <td>0.707107</td>
      <td>-0.707107</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.707107</td>
      <td>-0.707107</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-0.815759</td>
      <td>0.500000</td>
      <td>1.161895</td>
    </tr>
  </tbody>
</table>
</div>



### Groupby - filter
- 특정 조건으로 데이터를 검색할 때 사용
- filter안에는 boolean 조건이 존재해야한다.
- len(x)는 grouped된 DataFrame 개수


```python
df.groupby('Team').filter(lambda x : len(x) >= 3)
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Points</th>
      <th>Rank</th>
      <th>Team</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>876</td>
      <td>1</td>
      <td>Riders</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>1</th>
      <td>789</td>
      <td>2</td>
      <td>Riders</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4</th>
      <td>741</td>
      <td>3</td>
      <td>Kings</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>6</th>
      <td>756</td>
      <td>1</td>
      <td>Kings</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>7</th>
      <td>788</td>
      <td>1</td>
      <td>Kings</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>8</th>
      <td>694</td>
      <td>2</td>
      <td>Riders</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>11</th>
      <td>690</td>
      <td>2</td>
      <td>Riders</td>
      <td>2017</td>
    </tr>
  </tbody>
</table>
</div>



### Data
- 시간과 데이터 종류가 정리된 통화량 데이터


```python
import dateutil

df_phone = pd.read_csv('./data/phone_data.csv')
df_phone['date'] = df_phone['date'].apply(dateutil.parser.parse, dayfirst = True)
df_phone.head()
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>date</th>
      <th>duration</th>
      <th>item</th>
      <th>month</th>
      <th>network</th>
      <th>network_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2014-10-15 06:58:00</td>
      <td>34.429</td>
      <td>data</td>
      <td>2014-11</td>
      <td>data</td>
      <td>data</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2014-10-15 06:58:00</td>
      <td>13.000</td>
      <td>call</td>
      <td>2014-11</td>
      <td>Vodafone</td>
      <td>mobile</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2014-10-15 14:46:00</td>
      <td>23.000</td>
      <td>call</td>
      <td>2014-11</td>
      <td>Meteor</td>
      <td>mobile</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2014-10-15 14:48:00</td>
      <td>4.000</td>
      <td>call</td>
      <td>2014-11</td>
      <td>Tesco</td>
      <td>mobile</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2014-10-15 17:27:00</td>
      <td>4.000</td>
      <td>call</td>
      <td>2014-11</td>
      <td>Tesco</td>
      <td>mobile</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_phone.groupby('month')['duration'].sum()
```




    month
    2014-11    26639.441
    2014-12    14641.870
    2015-01    18223.299
    2015-02    15522.299
    2015-03    22750.441
    Name: duration, dtype: float64




```python
df_phone[df_phone['item'] == 'call'].groupby('network')['duration'].sum()
```




    network
    Meteor        7200.0
    Tesco        13828.0
    Three        36464.0
    Vodafone     14621.0
    landline     18433.0
    voicemail     1775.0
    Name: duration, dtype: float64




```python
df_phone.groupby(['month', 'item'])['date'].count()
```




    month    item
    2014-11  call    107
             data     29
             sms      94
    2014-12  call     79
             data     30
             sms      48
    2015-01  call     88
             data     31
             sms      86
    2015-02  call     67
             data     31
             sms      39
    2015-03  call     47
             data     29
             sms      25
    Name: date, dtype: int64




```python
df_phone.groupby(['month', 'item'])['date'].count().unstack()
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>item</th>
      <th>call</th>
      <th>data</th>
      <th>sms</th>
    </tr>
    <tr>
      <th>month</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2014-11</th>
      <td>107</td>
      <td>29</td>
      <td>94</td>
    </tr>
    <tr>
      <th>2014-12</th>
      <td>79</td>
      <td>30</td>
      <td>48</td>
    </tr>
    <tr>
      <th>2015-01</th>
      <td>88</td>
      <td>31</td>
      <td>86</td>
    </tr>
    <tr>
      <th>2015-02</th>
      <td>67</td>
      <td>31</td>
      <td>39</td>
    </tr>
    <tr>
      <th>2015-03</th>
      <td>47</td>
      <td>29</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_phone.groupby('month', as_index = False).agg({'duration' : 'sum'})
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>month</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-11</td>
      <td>26639.441</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-12</td>
      <td>14641.870</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2015-01</td>
      <td>18223.299</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2015-02</td>
      <td>15522.299</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2015-03</td>
      <td>22750.441</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_phone.groupby(['month', 'item']).agg({'duration' : sum,
                                         'network_type' : 'count',
                                         'date' : 'first'})
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>duration</th>
      <th>network_type</th>
      <th>date</th>
    </tr>
    <tr>
      <th>month</th>
      <th>item</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">2014-11</th>
      <th>call</th>
      <td>25547.000</td>
      <td>107</td>
      <td>2014-10-15 06:58:00</td>
    </tr>
    <tr>
      <th>data</th>
      <td>998.441</td>
      <td>29</td>
      <td>2014-10-15 06:58:00</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>94.000</td>
      <td>94</td>
      <td>2014-10-16 22:18:00</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2014-12</th>
      <th>call</th>
      <td>13561.000</td>
      <td>79</td>
      <td>2014-11-14 17:24:00</td>
    </tr>
    <tr>
      <th>data</th>
      <td>1032.870</td>
      <td>30</td>
      <td>2014-11-13 06:58:00</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>48.000</td>
      <td>48</td>
      <td>2014-11-14 17:28:00</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2015-01</th>
      <th>call</th>
      <td>17070.000</td>
      <td>88</td>
      <td>2014-12-15 20:03:00</td>
    </tr>
    <tr>
      <th>data</th>
      <td>1067.299</td>
      <td>31</td>
      <td>2014-12-13 06:58:00</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>86.000</td>
      <td>86</td>
      <td>2014-12-15 19:56:00</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2015-02</th>
      <th>call</th>
      <td>14416.000</td>
      <td>67</td>
      <td>2015-01-15 10:36:00</td>
    </tr>
    <tr>
      <th>data</th>
      <td>1067.299</td>
      <td>31</td>
      <td>2015-01-13 06:58:00</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>39.000</td>
      <td>39</td>
      <td>2015-01-15 12:23:00</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2015-03</th>
      <th>call</th>
      <td>21727.000</td>
      <td>47</td>
      <td>2015-02-12 20:15:00</td>
    </tr>
    <tr>
      <th>data</th>
      <td>998.441</td>
      <td>29</td>
      <td>2015-02-13 06:58:00</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>25.000</td>
      <td>25</td>
      <td>2015-02-19 18:46:00</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_phone.groupby(['month', 'item']).agg({'duration' : [min, max, sum],
                                     'network_type' : "count",
                                     'date' : [min, 'first', 'nunique']})
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">duration</th>
      <th>network_type</th>
      <th colspan="3" halign="left">date</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>min</th>
      <th>max</th>
      <th>sum</th>
      <th>count</th>
      <th>min</th>
      <th>first</th>
      <th>nunique</th>
    </tr>
    <tr>
      <th>month</th>
      <th>item</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">2014-11</th>
      <th>call</th>
      <td>1.000</td>
      <td>1940.000</td>
      <td>25547.000</td>
      <td>107</td>
      <td>2014-10-15 06:58:00</td>
      <td>2014-10-15 06:58:00</td>
      <td>104</td>
    </tr>
    <tr>
      <th>data</th>
      <td>34.429</td>
      <td>34.429</td>
      <td>998.441</td>
      <td>29</td>
      <td>2014-10-15 06:58:00</td>
      <td>2014-10-15 06:58:00</td>
      <td>29</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>94.000</td>
      <td>94</td>
      <td>2014-10-16 22:18:00</td>
      <td>2014-10-16 22:18:00</td>
      <td>79</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2014-12</th>
      <th>call</th>
      <td>2.000</td>
      <td>2120.000</td>
      <td>13561.000</td>
      <td>79</td>
      <td>2014-11-14 17:24:00</td>
      <td>2014-11-14 17:24:00</td>
      <td>76</td>
    </tr>
    <tr>
      <th>data</th>
      <td>34.429</td>
      <td>34.429</td>
      <td>1032.870</td>
      <td>30</td>
      <td>2014-11-13 06:58:00</td>
      <td>2014-11-13 06:58:00</td>
      <td>30</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>48.000</td>
      <td>48</td>
      <td>2014-11-14 17:28:00</td>
      <td>2014-11-14 17:28:00</td>
      <td>41</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2015-01</th>
      <th>call</th>
      <td>2.000</td>
      <td>1859.000</td>
      <td>17070.000</td>
      <td>88</td>
      <td>2014-12-15 20:03:00</td>
      <td>2014-12-15 20:03:00</td>
      <td>84</td>
    </tr>
    <tr>
      <th>data</th>
      <td>34.429</td>
      <td>34.429</td>
      <td>1067.299</td>
      <td>31</td>
      <td>2014-12-13 06:58:00</td>
      <td>2014-12-13 06:58:00</td>
      <td>31</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>86.000</td>
      <td>86</td>
      <td>2014-12-15 19:56:00</td>
      <td>2014-12-15 19:56:00</td>
      <td>58</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2015-02</th>
      <th>call</th>
      <td>1.000</td>
      <td>1863.000</td>
      <td>14416.000</td>
      <td>67</td>
      <td>2015-01-15 10:36:00</td>
      <td>2015-01-15 10:36:00</td>
      <td>67</td>
    </tr>
    <tr>
      <th>data</th>
      <td>34.429</td>
      <td>34.429</td>
      <td>1067.299</td>
      <td>31</td>
      <td>2015-01-13 06:58:00</td>
      <td>2015-01-13 06:58:00</td>
      <td>31</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>39.000</td>
      <td>39</td>
      <td>2015-01-15 12:23:00</td>
      <td>2015-01-15 12:23:00</td>
      <td>27</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2015-03</th>
      <th>call</th>
      <td>2.000</td>
      <td>10528.000</td>
      <td>21727.000</td>
      <td>47</td>
      <td>2015-02-12 20:15:00</td>
      <td>2015-02-12 20:15:00</td>
      <td>47</td>
    </tr>
    <tr>
      <th>data</th>
      <td>34.429</td>
      <td>34.429</td>
      <td>998.441</td>
      <td>29</td>
      <td>2015-02-13 06:58:00</td>
      <td>2015-02-13 06:58:00</td>
      <td>29</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>25.000</td>
      <td>25</td>
      <td>2015-02-19 18:46:00</td>
      <td>2015-02-19 18:46:00</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div>




```python
grouped = df_phone.groupby('month').agg( {"duration" : [min, max, np.mean]})

grouped.columns = grouped.columns.droplevel(level = 0)

grouped.rename(columns = {"min" : "min_duration",
                          "max" : "max_duration",
                          "mean" : "mean_duration"})
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_duration</th>
      <th>max_duration</th>
      <th>mean_duration</th>
    </tr>
    <tr>
      <th>month</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2014-11</th>
      <td>1.0</td>
      <td>1940.0</td>
      <td>115.823657</td>
    </tr>
    <tr>
      <th>2014-12</th>
      <td>1.0</td>
      <td>2120.0</td>
      <td>93.260318</td>
    </tr>
    <tr>
      <th>2015-01</th>
      <td>1.0</td>
      <td>1859.0</td>
      <td>88.894141</td>
    </tr>
    <tr>
      <th>2015-02</th>
      <td>1.0</td>
      <td>1863.0</td>
      <td>113.301453</td>
    </tr>
    <tr>
      <th>2015-03</th>
      <td>1.0</td>
      <td>10528.0</td>
      <td>225.251891</td>
    </tr>
  </tbody>
</table>
</div>



### Pivot Table
- 우리가 Excel에서 보던 그것
- index축은 groupby와 동일
- column에 추가로 labelling 값을 추가하여,<br/>
value에 numeric type값을 aggregation하는 형태


```python
df_phone = pd.read_csv("./data/phone_data.csv")
df_phone['date'] = df_phone['date'].apply(dateutil.parser.parse, dayfirst = True)
df_phone.head()
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>date</th>
      <th>duration</th>
      <th>item</th>
      <th>month</th>
      <th>network</th>
      <th>network_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2014-10-15 06:58:00</td>
      <td>34.429</td>
      <td>data</td>
      <td>2014-11</td>
      <td>data</td>
      <td>data</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2014-10-15 06:58:00</td>
      <td>13.000</td>
      <td>call</td>
      <td>2014-11</td>
      <td>Vodafone</td>
      <td>mobile</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2014-10-15 14:46:00</td>
      <td>23.000</td>
      <td>call</td>
      <td>2014-11</td>
      <td>Meteor</td>
      <td>mobile</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2014-10-15 14:48:00</td>
      <td>4.000</td>
      <td>call</td>
      <td>2014-11</td>
      <td>Tesco</td>
      <td>mobile</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2014-10-15 17:27:00</td>
      <td>4.000</td>
      <td>call</td>
      <td>2014-11</td>
      <td>Tesco</td>
      <td>mobile</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_phone.pivot_table(["duration"],
                     index = [df_phone.month,df_phone.item],
                     columns = df_phone.network, aggfunc = "sum", fill_value = 0)
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="9" halign="left">duration</th>
    </tr>
    <tr>
      <th></th>
      <th>network</th>
      <th>Meteor</th>
      <th>Tesco</th>
      <th>Three</th>
      <th>Vodafone</th>
      <th>data</th>
      <th>landline</th>
      <th>special</th>
      <th>voicemail</th>
      <th>world</th>
    </tr>
    <tr>
      <th>month</th>
      <th>item</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">2014-11</th>
      <th>call</th>
      <td>1521</td>
      <td>4045</td>
      <td>12458</td>
      <td>4316</td>
      <td>0.000</td>
      <td>2906</td>
      <td>0</td>
      <td>301</td>
      <td>0</td>
    </tr>
    <tr>
      <th>data</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>998.441</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>10</td>
      <td>3</td>
      <td>25</td>
      <td>55</td>
      <td>0.000</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2014-12</th>
      <th>call</th>
      <td>2010</td>
      <td>1819</td>
      <td>6316</td>
      <td>1302</td>
      <td>0.000</td>
      <td>1424</td>
      <td>0</td>
      <td>690</td>
      <td>0</td>
    </tr>
    <tr>
      <th>data</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1032.870</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>12</td>
      <td>1</td>
      <td>13</td>
      <td>18</td>
      <td>0.000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2015-01</th>
      <th>call</th>
      <td>2207</td>
      <td>2904</td>
      <td>6445</td>
      <td>3626</td>
      <td>0.000</td>
      <td>1603</td>
      <td>0</td>
      <td>285</td>
      <td>0</td>
    </tr>
    <tr>
      <th>data</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1067.299</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>10</td>
      <td>3</td>
      <td>33</td>
      <td>40</td>
      <td>0.000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2015-02</th>
      <th>call</th>
      <td>1188</td>
      <td>4087</td>
      <td>6279</td>
      <td>1864</td>
      <td>0.000</td>
      <td>730</td>
      <td>0</td>
      <td>268</td>
      <td>0</td>
    </tr>
    <tr>
      <th>data</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1067.299</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>1</td>
      <td>2</td>
      <td>11</td>
      <td>23</td>
      <td>0.000</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2015-03</th>
      <th>call</th>
      <td>274</td>
      <td>973</td>
      <td>4966</td>
      <td>3513</td>
      <td>0.000</td>
      <td>11770</td>
      <td>0</td>
      <td>231</td>
      <td>0</td>
    </tr>
    <tr>
      <th>data</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>998.441</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>sms</th>
      <td>0</td>
      <td>4</td>
      <td>5</td>
      <td>13</td>
      <td>0.000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>



### Crosstab
- 두 칼럼에 교차 빈도, 비율, 덧셈등을 구할 때 사용
- Pivot table의 특수한 형태
- User-Item Rating Matix등을 만들 때 사용 가능


```python
df_movie = pd.read_csv('./data/movie_rating.csv')
df_movie.head()
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>critic</th>
      <th>title</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jack Matthews</td>
      <td>Lady in the Water</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jack Matthews</td>
      <td>Snakes on a Plane</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack Matthews</td>
      <td>You Me and Dupree</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jack Matthews</td>
      <td>Superman Returns</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jack Matthews</td>
      <td>The Night Listener</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.crosstab(index = df_movie.critic, columns = df_movie.title,
            values = df_movie.rating, aggfunc = 'first').fillna(0)
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>title</th>
      <th>Just My Luck</th>
      <th>Lady in the Water</th>
      <th>Snakes on a Plane</th>
      <th>Superman Returns</th>
      <th>The Night Listener</th>
      <th>You Me and Dupree</th>
    </tr>
    <tr>
      <th>critic</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Claudia Puig</th>
      <td>3.0</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>4.0</td>
      <td>4.5</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>Gene Seymour</th>
      <td>1.5</td>
      <td>3.0</td>
      <td>3.5</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Jack Matthews</th>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Lisa Rose</th>
      <td>3.0</td>
      <td>2.5</td>
      <td>3.5</td>
      <td>3.5</td>
      <td>3.0</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>Mick LaSalle</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Toby</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.5</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_movie.pivot_table(['rating'], index = df_movie.critic, columns = df_movie.title,
                     aggfunc = 'sum', fill_value = 0)
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="6" halign="left">rating</th>
    </tr>
    <tr>
      <th>title</th>
      <th>Just My Luck</th>
      <th>Lady in the Water</th>
      <th>Snakes on a Plane</th>
      <th>Superman Returns</th>
      <th>The Night Listener</th>
      <th>You Me and Dupree</th>
    </tr>
    <tr>
      <th>critic</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Claudia Puig</th>
      <td>3.0</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>4.0</td>
      <td>4.5</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>Gene Seymour</th>
      <td>1.5</td>
      <td>3.0</td>
      <td>3.5</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Jack Matthews</th>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Lisa Rose</th>
      <td>3.0</td>
      <td>2.5</td>
      <td>3.5</td>
      <td>3.5</td>
      <td>3.0</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>Mick LaSalle</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Toby</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.5</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>



### Merge
- SQL에서 많이 사용하는 Merge와 같은 기능
- 두 개의 데이터를 하나로 합침


```python
raw_data = {'subject_id' : ['1', '2', '3', '4', '5', '7', '8', '9', '10', '11'],
            'test_score': [51, 15, 15, 61, 16, 14, 15, 1, 61, 16]}
df_a = pd.DataFrame(raw_data, columns = ['subject_id', 'test_score'])
df_a
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>test_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>51</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>61</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>16</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>14</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10</td>
      <td>61</td>
    </tr>
    <tr>
      <th>9</th>
      <td>11</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div>




```python
raw_data = {'subject_id': ['4', '5', '6', '7', '8'],
            'first_name': ['Billy', 'Brian', 'Bran', 'Bryce', 'Betty'],
            'last_name': ['Bonder', 'Black', 'Balwner', 'Brice', 'Btisan']}
df_b = pd.DataFrame(raw_data, columns = ['subject_id', 'first_name', 'last_name'])
df_b
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>Bran</td>
      <td>Balwner</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
  </tbody>
</table>
</div>



- subject_id기준으로 Merge


```python
pd.merge(df_a, df_b, on = 'subject_id')
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>test_score</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>61</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>16</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>14</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>15</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
  </tbody>
</table>
</div>



- 두 DataFrame column이름이 다를 때


```python
pd.merge(df_a, df_b, left_on = 'subject_id', right_on = 'subject_id')
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>test_score</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>61</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>16</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>14</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>15</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
  </tbody>
</table>
</div>



### Left Join


```python
pd.merge(df_a, df_b, on='subject_id', how='left')
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>test_score</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>51</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>15</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>15</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>61</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>16</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>14</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>15</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10</td>
      <td>61</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>11</td>
      <td>16</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



### Right Join


```python
pd.merge(df_a, df_b, on='subject_id', how='right')
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>test_score</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>61.0</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>16.0</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>14.0</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>15.0</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>NaN</td>
      <td>Bran</td>
      <td>Balwner</td>
    </tr>
  </tbody>
</table>
</div>



### Full(Outer) Join


```python
pd.merge(df_a, df_b, on = 'subject_id', how = 'outer')
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>test_score</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>51.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>15.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>15.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>61.0</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>16.0</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>14.0</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>15.0</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10</td>
      <td>61.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>11</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6</td>
      <td>NaN</td>
      <td>Bran</td>
      <td>Balwner</td>
    </tr>
  </tbody>
</table>
</div>



### Inner Join


```python
pd.merge(df_a, df_b, on = 'subject_id', how = 'inner')
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>test_score</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>61</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>16</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>14</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>15</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
  </tbody>
</table>
</div>



### Index based Join


```python
pd.merge(df_a, df_b, right_index = True, left_index = True)
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id_x</th>
      <th>test_score</th>
      <th>subject_id_y</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>51</td>
      <td>4</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>15</td>
      <td>5</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>15</td>
      <td>6</td>
      <td>Bran</td>
      <td>Balwner</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>61</td>
      <td>7</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>16</td>
      <td>8</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
  </tbody>
</table>
</div>



### Concat
- 같은 형태의 데이터를 붙이는 연산작업


```python
raw_data = {'subject_id' : ['1', '2', '3', '4', '5'],
            'first_name' : ['Alex', 'Amy', 'Allen', 'Alice', 'Ayoung'],
            'last_name' : ['Anderson', 'Ackerman', 'Ali', 'Aoni', 'Atiches']}
df_a = pd.DataFrame(raw_data, columns = ['subject_id', 'first_name', 'last_name'])
df_a
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alex</td>
      <td>Anderson</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Amy</td>
      <td>Ackerman</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Allen</td>
      <td>Ali</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Alice</td>
      <td>Aoni</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Ayoung</td>
      <td>Atiches</td>
    </tr>
  </tbody>
</table>
</div>




```python
raw_data = {'subject_id' : ['4', '5', '6', '7', '8'],
            'first_name' : ['Billy', 'Brian', 'Bran', 'Bryce', 'Betty'],
            'last_name' : ['Bonder', 'Black', 'Balwner', 'Brice', 'Btisan']}
df_b = pd.DataFrame(raw_data, columns = ['subject_id', 'first_name', 'last_name'])
df_b
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>Bran</td>
      <td>Balwner</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_new = pd.concat([df_a, df_b])
df_new.reset_index()
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>subject_id</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>Alex</td>
      <td>Anderson</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>Amy</td>
      <td>Ackerman</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>Allen</td>
      <td>Ali</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>Alice</td>
      <td>Aoni</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>Ayoung</td>
      <td>Atiches</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>4</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>5</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>6</td>
      <td>Bran</td>
      <td>Balwner</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>7</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>8</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_a.append(df_b)
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alex</td>
      <td>Anderson</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Amy</td>
      <td>Ackerman</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Allen</td>
      <td>Ali</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Alice</td>
      <td>Aoni</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Ayoung</td>
      <td>Atiches</td>
    </tr>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>Bran</td>
      <td>Balwner</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_new = pd.concat([df_a, df_b], axis = 1)
df_new.reset_index()
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>subject_id</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>subject_id</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>Alex</td>
      <td>Anderson</td>
      <td>4</td>
      <td>Billy</td>
      <td>Bonder</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>Amy</td>
      <td>Ackerman</td>
      <td>5</td>
      <td>Brian</td>
      <td>Black</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>Allen</td>
      <td>Ali</td>
      <td>6</td>
      <td>Bran</td>
      <td>Balwner</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>Alice</td>
      <td>Aoni</td>
      <td>7</td>
      <td>Bryce</td>
      <td>Brice</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>Ayoung</td>
      <td>Atiches</td>
      <td>8</td>
      <td>Betty</td>
      <td>Btisan</td>
    </tr>
  </tbody>
</table>
</div>



### Database connection
- Data loading시 db connection 기능을 제공


```python
import sqlite3

conn = sqlite3.connect('./data/flights.db')
cur = conn.cursor()
cur.execute('SELECT * FROM airlines LIMIT 5;')
results = cur.fetchall()
results
```




    [(0, '1', 'Private flight', '\\N', '-', None, None, None, 'Y'),
     (1, '2', '135 Airways', '\\N', None, 'GNL', 'GENERAL', 'United States', 'N'),
     (2, '3', '1Time Airline', '\\N', '1T', 'RNX', 'NEXTIME', 'South Africa', 'Y'),
     (3,
      '4',
      '2 Sqn No 1 Elementary Flying Training School',
      '\\N',
      None,
      'WYT',
      None,
      'United Kingdom',
      'N'),
     (4, '5', '213 Flight Unit', '\\N', None, 'TFU', None, 'Russia', 'N')]




```python
df_airplines = pd.read_sql_query("SELECT * FROM airlines;", conn)
df_airports = pd.read_sql_query("SELECT * FROM airports;", conn)
df_routes = pd.read_sql_query("SELECT * FROM routes;", conn)
```


```python
df_airplines
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>name</th>
      <th>alias</th>
      <th>iata</th>
      <th>icao</th>
      <th>callsign</th>
      <th>country</th>
      <th>active</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>Private flight</td>
      <td>\N</td>
      <td>-</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>135 Airways</td>
      <td>\N</td>
      <td>None</td>
      <td>GNL</td>
      <td>GENERAL</td>
      <td>United States</td>
      <td>N</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>1Time Airline</td>
      <td>\N</td>
      <td>1T</td>
      <td>RNX</td>
      <td>NEXTIME</td>
      <td>South Africa</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>2 Sqn No 1 Elementary Flying Training School</td>
      <td>\N</td>
      <td>None</td>
      <td>WYT</td>
      <td>None</td>
      <td>United Kingdom</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>213 Flight Unit</td>
      <td>\N</td>
      <td>None</td>
      <td>TFU</td>
      <td>None</td>
      <td>Russia</td>
      <td>N</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>6</td>
      <td>223 Flight Unit State Airline</td>
      <td>\N</td>
      <td>None</td>
      <td>CHD</td>
      <td>CHKALOVSK-AVIA</td>
      <td>Russia</td>
      <td>N</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>7</td>
      <td>224th Flight Unit</td>
      <td>\N</td>
      <td>None</td>
      <td>TTF</td>
      <td>CARGO UNIT</td>
      <td>Russia</td>
      <td>N</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>8</td>
      <td>247 Jet Ltd</td>
      <td>\N</td>
      <td>None</td>
      <td>TWF</td>
      <td>CLOUD RUNNER</td>
      <td>United Kingdom</td>
      <td>N</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>9</td>
      <td>3D Aviation</td>
      <td>\N</td>
      <td>None</td>
      <td>SEC</td>
      <td>SECUREX</td>
      <td>United States</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>10</td>
      <td>40-Mile Air</td>
      <td>\N</td>
      <td>Q5</td>
      <td>MLA</td>
      <td>MILE-AIR</td>
      <td>United States</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>11</td>
      <td>4D Air</td>
      <td>\N</td>
      <td>None</td>
      <td>QRT</td>
      <td>QUARTET</td>
      <td>Thailand</td>
      <td>N</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>12</td>
      <td>611897 Alberta Limited</td>
      <td>\N</td>
      <td>None</td>
      <td>THD</td>
      <td>DONUT</td>
      <td>Canada</td>
      <td>N</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>13</td>
      <td>Ansett Australia</td>
      <td>\N</td>
      <td>AN</td>
      <td>AAA</td>
      <td>ANSETT</td>
      <td>Australia</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
      <td>14</td>
      <td>Abacus International</td>
      <td>\N</td>
      <td>1B</td>
      <td>None</td>
      <td>None</td>
      <td>Singapore</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
      <td>15</td>
      <td>Abelag Aviation</td>
      <td>\N</td>
      <td>W9</td>
      <td>AAB</td>
      <td>ABG</td>
      <td>Belgium</td>
      <td>N</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>16</td>
      <td>Army Air Corps</td>
      <td>\N</td>
      <td>None</td>
      <td>AAC</td>
      <td>ARMYAIR</td>
      <td>United Kingdom</td>
      <td>N</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
      <td>17</td>
      <td>Aero Aviation Centre Ltd.</td>
      <td>\N</td>
      <td>None</td>
      <td>AAD</td>
      <td>SUNRISE</td>
      <td>Canada</td>
      <td>N</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
      <td>18</td>
      <td>Aero Servicios Ejecutivos Internacionales</td>
      <td>\N</td>
      <td>None</td>
      <td>SII</td>
      <td>ASEISA</td>
      <td>Mexico</td>
      <td>N</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
      <td>19</td>
      <td>Aero Biniza</td>
      <td>\N</td>
      <td>None</td>
      <td>BZS</td>
      <td>BINIZA</td>
      <td>Mexico</td>
      <td>N</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
      <td>20</td>
      <td>Aero Albatros</td>
      <td>\N</td>
      <td>None</td>
      <td>ABM</td>
      <td>ALBATROS ESPANA</td>
      <td>Spain</td>
      <td>N</td>
    </tr>
    <tr>
      <th>20</th>
      <td>20</td>
      <td>21</td>
      <td>Aigle Azur</td>
      <td>\N</td>
      <td>ZI</td>
      <td>AAF</td>
      <td>AIGLE AZUR</td>
      <td>France</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>21</th>
      <td>21</td>
      <td>22</td>
      <td>Aloha Airlines</td>
      <td>\N</td>
      <td>AQ</td>
      <td>AAH</td>
      <td>ALOHA</td>
      <td>United States</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>22</th>
      <td>22</td>
      <td>23</td>
      <td>Alaska Island Air</td>
      <td>\N</td>
      <td>None</td>
      <td>AAK</td>
      <td>ALASKA ISLAND</td>
      <td>United States</td>
      <td>N</td>
    </tr>
    <tr>
      <th>23</th>
      <td>23</td>
      <td>24</td>
      <td>American Airlines</td>
      <td>\N</td>
      <td>AA</td>
      <td>AAL</td>
      <td>AMERICAN</td>
      <td>United States</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>24</th>
      <td>24</td>
      <td>25</td>
      <td>Aviation Management Corporation</td>
      <td>\N</td>
      <td>None</td>
      <td>AAM</td>
      <td>AM CORP</td>
      <td>United States</td>
      <td>N</td>
    </tr>
    <tr>
      <th>25</th>
      <td>25</td>
      <td>26</td>
      <td>Atlantis Airlines (USA)</td>
      <td>\N</td>
      <td>None</td>
      <td>AAO</td>
      <td>ATLANTIS AIR</td>
      <td>United States</td>
      <td>N</td>
    </tr>
    <tr>
      <th>26</th>
      <td>26</td>
      <td>27</td>
      <td>Aerovista Airlines</td>
      <td>\N</td>
      <td>None</td>
      <td>AAP</td>
      <td>AEROVISTA GROUP</td>
      <td>United Arab Emirates</td>
      <td>N</td>
    </tr>
    <tr>
      <th>27</th>
      <td>27</td>
      <td>28</td>
      <td>Asiana Airlines</td>
      <td>\N</td>
      <td>OZ</td>
      <td>AAR</td>
      <td>ASIANA</td>
      <td>Republic of Korea</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>28</th>
      <td>28</td>
      <td>29</td>
      <td>Askari Aviation</td>
      <td>\N</td>
      <td>4K</td>
      <td>AAS</td>
      <td>AL-AAS</td>
      <td>Pakistan</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>29</th>
      <td>29</td>
      <td>30</td>
      <td>Australia Asia Airlines</td>
      <td>\N</td>
      <td>None</td>
      <td>AAU</td>
      <td>AUSTASIA</td>
      <td>Australia</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6018</th>
      <td>6018</td>
      <td>19651</td>
      <td>CARICOM AIRWAYS (BARBADOS) INC.</td>
      <td>CARICOM AIRWAYS</td>
      <td>None</td>
      <td>CCB</td>
      <td>None</td>
      <td>Barbados</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6019</th>
      <td>6019</td>
      <td>19674</td>
      <td>Rainbow Air (RAI)</td>
      <td>Rainbow Air (RAI)</td>
      <td>RN</td>
      <td>RAB</td>
      <td>Rainbow</td>
      <td>United States</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6020</th>
      <td>6020</td>
      <td>19675</td>
      <td>Rainbow Air Canada</td>
      <td>Rainbow Air CAN</td>
      <td>RY</td>
      <td>RAY</td>
      <td>Rainbow CAN</td>
      <td>Canada</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6021</th>
      <td>6021</td>
      <td>19676</td>
      <td>Rainbow Air Polynesia</td>
      <td>Rainbow Air POL</td>
      <td>RX</td>
      <td>RPO</td>
      <td>Rainbow Air</td>
      <td>United States</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6022</th>
      <td>6022</td>
      <td>19677</td>
      <td>Rainbow Air Euro</td>
      <td>Rainbow Air EU</td>
      <td>RU</td>
      <td>RUE</td>
      <td>Rainbow Air</td>
      <td>United Kingdom</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6023</th>
      <td>6023</td>
      <td>19678</td>
      <td>Rainbow Air US</td>
      <td>Rainbow Air US</td>
      <td>RM</td>
      <td>RNY</td>
      <td>Rainbow Air</td>
      <td>United States</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6024</th>
      <td>6024</td>
      <td>19745</td>
      <td>Transilvania</td>
      <td>None</td>
      <td>None</td>
      <td>TNS</td>
      <td>None</td>
      <td>Romania</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6025</th>
      <td>6025</td>
      <td>19751</td>
      <td>Dobrolet</td>
      <td>Добролёт</td>
      <td>QD</td>
      <td>DOB</td>
      <td>DOBROLET</td>
      <td>Russia</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6026</th>
      <td>6026</td>
      <td>19774</td>
      <td>Spike Airlines</td>
      <td>Aero Spike</td>
      <td>S0</td>
      <td>SAL</td>
      <td>Spike Air</td>
      <td>United States</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6027</th>
      <td>6027</td>
      <td>19776</td>
      <td>Grand Cru Airlines</td>
      <td>None</td>
      <td>None</td>
      <td>GCA</td>
      <td>None</td>
      <td>Lithuania</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6028</th>
      <td>6028</td>
      <td>19785</td>
      <td>Go2Sky</td>
      <td>None</td>
      <td>None</td>
      <td>RLX</td>
      <td>RELAX</td>
      <td>Slovakia</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6029</th>
      <td>6029</td>
      <td>19803</td>
      <td>All Argentina</td>
      <td>All Argentina</td>
      <td>L1</td>
      <td>AL1</td>
      <td>None</td>
      <td>Argentina</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6030</th>
      <td>6030</td>
      <td>19804</td>
      <td>All America</td>
      <td>All America</td>
      <td>A2</td>
      <td>AL2</td>
      <td>None</td>
      <td>United States</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6031</th>
      <td>6031</td>
      <td>19805</td>
      <td>All Asia</td>
      <td>All Asia</td>
      <td>L9</td>
      <td>AL3</td>
      <td>None</td>
      <td>China</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6032</th>
      <td>6032</td>
      <td>19806</td>
      <td>All Africa</td>
      <td>All Africa</td>
      <td>9A</td>
      <td>99F</td>
      <td>None</td>
      <td>South Africa</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6033</th>
      <td>6033</td>
      <td>19807</td>
      <td>Regionalia México</td>
      <td>Regionalia México</td>
      <td>N4</td>
      <td>J88</td>
      <td>None</td>
      <td>Mexico</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6034</th>
      <td>6034</td>
      <td>19808</td>
      <td>All Europe</td>
      <td>All Europe</td>
      <td>N9</td>
      <td>N99</td>
      <td>None</td>
      <td>United Kingdom</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6035</th>
      <td>6035</td>
      <td>19809</td>
      <td>All Spain</td>
      <td>All Spain</td>
      <td>N7</td>
      <td>N77</td>
      <td>None</td>
      <td>Spain</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6036</th>
      <td>6036</td>
      <td>19810</td>
      <td>Regional Air Iceland</td>
      <td>Regional Air Iceland</td>
      <td>9N</td>
      <td>N78</td>
      <td>None</td>
      <td>Iceland</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6037</th>
      <td>6037</td>
      <td>19811</td>
      <td>British Air Ferries</td>
      <td>None</td>
      <td>??</td>
      <td>??!</td>
      <td>None</td>
      <td>United Kingdom</td>
      <td>N</td>
    </tr>
    <tr>
      <th>6038</th>
      <td>6038</td>
      <td>19812</td>
      <td>Voestar</td>
      <td>Voestar Brasil</td>
      <td>8K</td>
      <td>K88</td>
      <td>None</td>
      <td>Brazil</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6039</th>
      <td>6039</td>
      <td>19813</td>
      <td>All Colombia</td>
      <td>All Colombia</td>
      <td>7O</td>
      <td>7KK</td>
      <td>None</td>
      <td>Colombia</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6040</th>
      <td>6040</td>
      <td>19814</td>
      <td>Regionalia Uruguay</td>
      <td>Regionalia Uruguay</td>
      <td>2X</td>
      <td>2K2</td>
      <td>None</td>
      <td>Uruguay</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6041</th>
      <td>6041</td>
      <td>19815</td>
      <td>Regionalia Venezuela</td>
      <td>Regionalia Venezuela</td>
      <td>9X</td>
      <td>9XX</td>
      <td>None</td>
      <td>Venezuela</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6042</th>
      <td>6042</td>
      <td>19827</td>
      <td>Regionalia Chile</td>
      <td>Regionalia Chile</td>
      <td>9J</td>
      <td>CR1</td>
      <td>None</td>
      <td>Chile</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6043</th>
      <td>6043</td>
      <td>19828</td>
      <td>Vuela Cuba</td>
      <td>Vuela Cuba</td>
      <td>6C</td>
      <td>6CC</td>
      <td>None</td>
      <td>Cuba</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6044</th>
      <td>6044</td>
      <td>19830</td>
      <td>All Australia</td>
      <td>All Australia</td>
      <td>88</td>
      <td>8K8</td>
      <td>None</td>
      <td>Australia</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6045</th>
      <td>6045</td>
      <td>19831</td>
      <td>Fly Europa</td>
      <td>None</td>
      <td>ER</td>
      <td>RWW</td>
      <td>None</td>
      <td>Spain</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6046</th>
      <td>6046</td>
      <td>19834</td>
      <td>FlyPortugal</td>
      <td>None</td>
      <td>PO</td>
      <td>FPT</td>
      <td>FlyPortugal</td>
      <td>Portugal</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6047</th>
      <td>6047</td>
      <td>19845</td>
      <td>FTI Fluggesellschaft</td>
      <td>None</td>
      <td>None</td>
      <td>FTI</td>
      <td>None</td>
      <td>Germany</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
<p>6048 rows × 9 columns</p>
</div>




```python
df_airports
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>name</th>
      <th>city</th>
      <th>country</th>
      <th>code</th>
      <th>icao</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>altitude</th>
      <th>offset</th>
      <th>dst</th>
      <th>timezone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>Goroka</td>
      <td>Goroka</td>
      <td>Papua New Guinea</td>
      <td>GKA</td>
      <td>AYGA</td>
      <td>-6.081689</td>
      <td>145.391881</td>
      <td>5282</td>
      <td>10</td>
      <td>U</td>
      <td>Pacific/Port_Moresby</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>Madang</td>
      <td>Madang</td>
      <td>Papua New Guinea</td>
      <td>MAG</td>
      <td>AYMD</td>
      <td>-5.207083</td>
      <td>145.7887</td>
      <td>20</td>
      <td>10</td>
      <td>U</td>
      <td>Pacific/Port_Moresby</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>Mount Hagen</td>
      <td>Mount Hagen</td>
      <td>Papua New Guinea</td>
      <td>HGU</td>
      <td>AYMH</td>
      <td>-5.826789</td>
      <td>144.295861</td>
      <td>5388</td>
      <td>10</td>
      <td>U</td>
      <td>Pacific/Port_Moresby</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>Nadzab</td>
      <td>Nadzab</td>
      <td>Papua New Guinea</td>
      <td>LAE</td>
      <td>AYNZ</td>
      <td>-6.569828</td>
      <td>146.726242</td>
      <td>239</td>
      <td>10</td>
      <td>U</td>
      <td>Pacific/Port_Moresby</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>Port Moresby Jacksons Intl</td>
      <td>Port Moresby</td>
      <td>Papua New Guinea</td>
      <td>POM</td>
      <td>AYPY</td>
      <td>-9.443383</td>
      <td>147.22005</td>
      <td>146</td>
      <td>10</td>
      <td>U</td>
      <td>Pacific/Port_Moresby</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>6</td>
      <td>Wewak Intl</td>
      <td>Wewak</td>
      <td>Papua New Guinea</td>
      <td>WWK</td>
      <td>AYWK</td>
      <td>-3.583828</td>
      <td>143.669186</td>
      <td>19</td>
      <td>10</td>
      <td>U</td>
      <td>Pacific/Port_Moresby</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>7</td>
      <td>Narsarsuaq</td>
      <td>Narssarssuaq</td>
      <td>Greenland</td>
      <td>UAK</td>
      <td>BGBW</td>
      <td>61.160517</td>
      <td>-45.425978</td>
      <td>112</td>
      <td>-3</td>
      <td>E</td>
      <td>America/Godthab</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>8</td>
      <td>Nuuk</td>
      <td>Godthaab</td>
      <td>Greenland</td>
      <td>GOH</td>
      <td>BGGH</td>
      <td>64.190922</td>
      <td>-51.678064</td>
      <td>283</td>
      <td>-3</td>
      <td>E</td>
      <td>America/Godthab</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>9</td>
      <td>Sondre Stromfjord</td>
      <td>Sondrestrom</td>
      <td>Greenland</td>
      <td>SFJ</td>
      <td>BGSF</td>
      <td>67.016969</td>
      <td>-50.689325</td>
      <td>165</td>
      <td>-3</td>
      <td>E</td>
      <td>America/Godthab</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>10</td>
      <td>Thule Air Base</td>
      <td>Thule</td>
      <td>Greenland</td>
      <td>THU</td>
      <td>BGTL</td>
      <td>76.531203</td>
      <td>-68.703161</td>
      <td>251</td>
      <td>-4</td>
      <td>E</td>
      <td>America/Thule</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>11</td>
      <td>Akureyri</td>
      <td>Akureyri</td>
      <td>Iceland</td>
      <td>AEY</td>
      <td>BIAR</td>
      <td>65.659994</td>
      <td>-18.072703</td>
      <td>6</td>
      <td>0</td>
      <td>N</td>
      <td>Atlantic/Reykjavik</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>12</td>
      <td>Egilsstadir</td>
      <td>Egilsstadir</td>
      <td>Iceland</td>
      <td>EGS</td>
      <td>BIEG</td>
      <td>65.283333</td>
      <td>-14.401389</td>
      <td>76</td>
      <td>0</td>
      <td>N</td>
      <td>Atlantic/Reykjavik</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>13</td>
      <td>Hornafjordur</td>
      <td>Hofn</td>
      <td>Iceland</td>
      <td>HFN</td>
      <td>BIHN</td>
      <td>64.295556</td>
      <td>-15.227222</td>
      <td>24</td>
      <td>0</td>
      <td>N</td>
      <td>Atlantic/Reykjavik</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
      <td>14</td>
      <td>Husavik</td>
      <td>Husavik</td>
      <td>Iceland</td>
      <td>HZK</td>
      <td>BIHU</td>
      <td>65.952328</td>
      <td>-17.425978</td>
      <td>48</td>
      <td>0</td>
      <td>N</td>
      <td>Atlantic/Reykjavik</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
      <td>15</td>
      <td>Isafjordur</td>
      <td>Isafjordur</td>
      <td>Iceland</td>
      <td>IFJ</td>
      <td>BIIS</td>
      <td>66.058056</td>
      <td>-23.135278</td>
      <td>8</td>
      <td>0</td>
      <td>N</td>
      <td>Atlantic/Reykjavik</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>16</td>
      <td>Keflavik International Airport</td>
      <td>Keflavik</td>
      <td>Iceland</td>
      <td>KEF</td>
      <td>BIKF</td>
      <td>63.985</td>
      <td>-22.605556</td>
      <td>171</td>
      <td>0</td>
      <td>N</td>
      <td>Atlantic/Reykjavik</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
      <td>17</td>
      <td>Patreksfjordur</td>
      <td>Patreksfjordur</td>
      <td>Iceland</td>
      <td>PFJ</td>
      <td>BIPA</td>
      <td>65.555833</td>
      <td>-23.965</td>
      <td>11</td>
      <td>0</td>
      <td>N</td>
      <td>Atlantic/Reykjavik</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
      <td>18</td>
      <td>Reykjavik</td>
      <td>Reykjavik</td>
      <td>Iceland</td>
      <td>RKV</td>
      <td>BIRK</td>
      <td>64.13</td>
      <td>-21.940556</td>
      <td>48</td>
      <td>0</td>
      <td>N</td>
      <td>Atlantic/Reykjavik</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
      <td>19</td>
      <td>Siglufjordur</td>
      <td>Siglufjordur</td>
      <td>Iceland</td>
      <td>SIJ</td>
      <td>BISI</td>
      <td>66.133333</td>
      <td>-18.916667</td>
      <td>10</td>
      <td>0</td>
      <td>N</td>
      <td>Atlantic/Reykjavik</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
      <td>20</td>
      <td>Vestmannaeyjar</td>
      <td>Vestmannaeyjar</td>
      <td>Iceland</td>
      <td>VEY</td>
      <td>BIVM</td>
      <td>63.424303</td>
      <td>-20.278875</td>
      <td>326</td>
      <td>0</td>
      <td>N</td>
      <td>Atlantic/Reykjavik</td>
    </tr>
    <tr>
      <th>20</th>
      <td>20</td>
      <td>21</td>
      <td>Sault Ste Marie</td>
      <td>Sault Sainte Marie</td>
      <td>Canada</td>
      <td>YAM</td>
      <td>CYAM</td>
      <td>46.485001</td>
      <td>-84.509445</td>
      <td>630</td>
      <td>-5</td>
      <td>A</td>
      <td>America/Toronto</td>
    </tr>
    <tr>
      <th>21</th>
      <td>21</td>
      <td>22</td>
      <td>Winnipeg St Andrews</td>
      <td>Winnipeg</td>
      <td>Canada</td>
      <td>YAV</td>
      <td>CYAV</td>
      <td>50.056389</td>
      <td>-97.0325</td>
      <td>760</td>
      <td>-6</td>
      <td>A</td>
      <td>America/Winnipeg</td>
    </tr>
    <tr>
      <th>22</th>
      <td>22</td>
      <td>23</td>
      <td>Shearwater</td>
      <td>Halifax</td>
      <td>Canada</td>
      <td>YAW</td>
      <td>CYAW</td>
      <td>44.639721</td>
      <td>-63.499444</td>
      <td>167</td>
      <td>-4</td>
      <td>A</td>
      <td>America/Halifax</td>
    </tr>
    <tr>
      <th>23</th>
      <td>23</td>
      <td>24</td>
      <td>St Anthony</td>
      <td>St. Anthony</td>
      <td>Canada</td>
      <td>YAY</td>
      <td>CYAY</td>
      <td>51.391944</td>
      <td>-56.083056</td>
      <td>108</td>
      <td>-3.5</td>
      <td>A</td>
      <td>America/St_Johns</td>
    </tr>
    <tr>
      <th>24</th>
      <td>24</td>
      <td>25</td>
      <td>Tofino</td>
      <td>Tofino</td>
      <td>Canada</td>
      <td>YAZ</td>
      <td>CYAZ</td>
      <td>49.082222</td>
      <td>-125.7725</td>
      <td>80</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Vancouver</td>
    </tr>
    <tr>
      <th>25</th>
      <td>25</td>
      <td>26</td>
      <td>Kugaaruk</td>
      <td>Pelly Bay</td>
      <td>Canada</td>
      <td>YBB</td>
      <td>CYBB</td>
      <td>68.534444</td>
      <td>-89.808056</td>
      <td>56</td>
      <td>-7</td>
      <td>A</td>
      <td>America/Edmonton</td>
    </tr>
    <tr>
      <th>26</th>
      <td>26</td>
      <td>27</td>
      <td>Baie Comeau</td>
      <td>Baie Comeau</td>
      <td>Canada</td>
      <td>YBC</td>
      <td>CYBC</td>
      <td>49.1325</td>
      <td>-68.204444</td>
      <td>71</td>
      <td>-5</td>
      <td>A</td>
      <td>America/Toronto</td>
    </tr>
    <tr>
      <th>27</th>
      <td>27</td>
      <td>28</td>
      <td>Bagotville</td>
      <td>Bagotville</td>
      <td>Canada</td>
      <td>YBG</td>
      <td>CYBG</td>
      <td>48.330555</td>
      <td>-70.996391</td>
      <td>522</td>
      <td>-5</td>
      <td>A</td>
      <td>America/Toronto</td>
    </tr>
    <tr>
      <th>28</th>
      <td>28</td>
      <td>29</td>
      <td>Baker Lake</td>
      <td>Baker Lake</td>
      <td>Canada</td>
      <td>YBK</td>
      <td>CYBK</td>
      <td>64.298889</td>
      <td>-96.077778</td>
      <td>59</td>
      <td>-6</td>
      <td>A</td>
      <td>America/Winnipeg</td>
    </tr>
    <tr>
      <th>29</th>
      <td>29</td>
      <td>30</td>
      <td>Campbell River</td>
      <td>Campbell River</td>
      <td>Canada</td>
      <td>YBL</td>
      <td>CYBL</td>
      <td>49.950832</td>
      <td>-125.270833</td>
      <td>346</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Vancouver</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8077</th>
      <td>8077</td>
      <td>9512</td>
      <td>Port of Seattle</td>
      <td>Seattle</td>
      <td>United States</td>
      <td>None</td>
      <td>PSEA</td>
      <td>47.609178</td>
      <td>-122.350605</td>
      <td>0</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Los_Angeles</td>
    </tr>
    <tr>
      <th>8078</th>
      <td>8078</td>
      <td>9513</td>
      <td>Ferry Terminal</td>
      <td>Whittier</td>
      <td>United States</td>
      <td>None</td>
      <td>WHIT</td>
      <td>60.776566</td>
      <td>-148.683367</td>
      <td>0</td>
      <td>-9</td>
      <td>A</td>
      <td>America/Anchorage</td>
    </tr>
    <tr>
      <th>8079</th>
      <td>8079</td>
      <td>9514</td>
      <td>Ferry Terminal</td>
      <td>Valdez</td>
      <td>United States</td>
      <td>None</td>
      <td>VLDZ</td>
      <td>61.123976</td>
      <td>-146.365309</td>
      <td>0</td>
      <td>-9</td>
      <td>A</td>
      <td>America/Anchorage</td>
    </tr>
    <tr>
      <th>8080</th>
      <td>8080</td>
      <td>9515</td>
      <td>Gare Routiere</td>
      <td>Saint-Louis</td>
      <td>Reunion</td>
      <td>None</td>
      <td>STLS</td>
      <td>-21.289604</td>
      <td>55.407269</td>
      <td>103</td>
      <td>4</td>
      <td>E</td>
      <td>Indian/Reunion</td>
    </tr>
    <tr>
      <th>8081</th>
      <td>8081</td>
      <td>9516</td>
      <td>Bus Stop</td>
      <td>La Riviere</td>
      <td>Reunion</td>
      <td>None</td>
      <td>LRIV</td>
      <td>-21.272574</td>
      <td>55.437706</td>
      <td>190</td>
      <td>4</td>
      <td>E</td>
      <td>Indian/Reunion</td>
    </tr>
    <tr>
      <th>8082</th>
      <td>8082</td>
      <td>9517</td>
      <td>Bus Stop</td>
      <td>Cilaos</td>
      <td>Reunion</td>
      <td>None</td>
      <td>CILS</td>
      <td>-21.135518</td>
      <td>55.472087</td>
      <td>4000</td>
      <td>4</td>
      <td>E</td>
      <td>Indian/Reunion</td>
    </tr>
    <tr>
      <th>8083</th>
      <td>8083</td>
      <td>9518</td>
      <td>Bus Stop</td>
      <td>Hell-Bourg</td>
      <td>Reunion</td>
      <td>None</td>
      <td>HLBG</td>
      <td>-21.06402</td>
      <td>55.518453</td>
      <td>3000</td>
      <td>4</td>
      <td>E</td>
      <td>Indian/Reunion</td>
    </tr>
    <tr>
      <th>8084</th>
      <td>8084</td>
      <td>9519</td>
      <td>Bus Stop</td>
      <td>Salazie</td>
      <td>Reunion</td>
      <td>None</td>
      <td>SLZI</td>
      <td>-21.027485</td>
      <td>55.538955</td>
      <td>3000</td>
      <td>4</td>
      <td>E</td>
      <td>Indian/Reunion</td>
    </tr>
    <tr>
      <th>8085</th>
      <td>8085</td>
      <td>9520</td>
      <td>Gare</td>
      <td>St Andre</td>
      <td>Reunion</td>
      <td>None</td>
      <td>ANDR</td>
      <td>-20.963272</td>
      <td>55.652508</td>
      <td>100</td>
      <td>4</td>
      <td>E</td>
      <td>Indian/Reunion</td>
    </tr>
    <tr>
      <th>8086</th>
      <td>8086</td>
      <td>9521</td>
      <td>L'Ocean Bus Terminal</td>
      <td>Saint Denis</td>
      <td>Reunion</td>
      <td>None</td>
      <td>SDNS</td>
      <td>-20.877683</td>
      <td>55.457393</td>
      <td>0</td>
      <td>4</td>
      <td>E</td>
      <td>Indian/Reunion</td>
    </tr>
    <tr>
      <th>8087</th>
      <td>8087</td>
      <td>9522</td>
      <td>Gare Routiere</td>
      <td>Saint Pierre</td>
      <td>Reunion</td>
      <td>None</td>
      <td>STPR</td>
      <td>-21.33424</td>
      <td>55.471331</td>
      <td>0</td>
      <td>4</td>
      <td>E</td>
      <td>Indian/Reunion</td>
    </tr>
    <tr>
      <th>8088</th>
      <td>8088</td>
      <td>9523</td>
      <td>Baie Ste Anne</td>
      <td>Praslin</td>
      <td>Seychelles</td>
      <td>None</td>
      <td>PLIN</td>
      <td>-4.347119</td>
      <td>55.765688</td>
      <td>0</td>
      <td>4</td>
      <td>N</td>
      <td>Indian/Mahe</td>
    </tr>
    <tr>
      <th>8089</th>
      <td>8089</td>
      <td>9524</td>
      <td>La Passe</td>
      <td>La Digue</td>
      <td>Seychelles</td>
      <td>None</td>
      <td>LADG</td>
      <td>-4.347969</td>
      <td>55.829069</td>
      <td>0</td>
      <td>4</td>
      <td>N</td>
      <td>Indian/Mahe</td>
    </tr>
    <tr>
      <th>8090</th>
      <td>8090</td>
      <td>9525</td>
      <td>Ferry Dock</td>
      <td>Bainbridge Island</td>
      <td>United States</td>
      <td>None</td>
      <td>BAIN</td>
      <td>47.622237</td>
      <td>-122.509362</td>
      <td>0</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Los_Angeles</td>
    </tr>
    <tr>
      <th>8091</th>
      <td>8091</td>
      <td>9526</td>
      <td>Bus</td>
      <td>Phnom Penh</td>
      <td>Cambodia</td>
      <td>None</td>
      <td>PNMP</td>
      <td>11.561716</td>
      <td>104.914276</td>
      <td>0</td>
      <td>7</td>
      <td>N</td>
      <td>Asia/Phnom_Penh</td>
    </tr>
    <tr>
      <th>8092</th>
      <td>8092</td>
      <td>9527</td>
      <td>Bus</td>
      <td>Siem Reap</td>
      <td>Cambodia</td>
      <td>None</td>
      <td>SMRP</td>
      <td>13.361002</td>
      <td>103.859543</td>
      <td>0</td>
      <td>7</td>
      <td>N</td>
      <td>Asia/Phnom_Penh</td>
    </tr>
    <tr>
      <th>8093</th>
      <td>8093</td>
      <td>9528</td>
      <td>Bus</td>
      <td>Sihanoukville</td>
      <td>Cambodia</td>
      <td>None</td>
      <td>SNKV</td>
      <td>10.60722</td>
      <td>103.524886</td>
      <td>0</td>
      <td>7</td>
      <td>N</td>
      <td>Asia/Phnom_Penh</td>
    </tr>
    <tr>
      <th>8094</th>
      <td>8094</td>
      <td>9529</td>
      <td>Bus</td>
      <td>Kampot</td>
      <td>Cambodia</td>
      <td>None</td>
      <td>KMPT</td>
      <td>10.614922</td>
      <td>104.177724</td>
      <td>0</td>
      <td>7</td>
      <td>N</td>
      <td>Asia/Phnom_Penh</td>
    </tr>
    <tr>
      <th>8095</th>
      <td>8095</td>
      <td>9530</td>
      <td>Bus</td>
      <td>Kep</td>
      <td>Cambodia</td>
      <td>None</td>
      <td>KEPC</td>
      <td>10.480174</td>
      <td>104.294228</td>
      <td>0</td>
      <td>7</td>
      <td>N</td>
      <td>Asia/Phnom_Penh</td>
    </tr>
    <tr>
      <th>8096</th>
      <td>8096</td>
      <td>9531</td>
      <td>Main Station</td>
      <td>Taipei</td>
      <td>Taiwan</td>
      <td>None</td>
      <td>TPEI</td>
      <td>25.046176</td>
      <td>121.517532</td>
      <td>0</td>
      <td>8</td>
      <td>N</td>
      <td>Asia/Taipei</td>
    </tr>
    <tr>
      <th>8097</th>
      <td>8097</td>
      <td>9532</td>
      <td>Prominent Hill</td>
      <td>Prominent Hill</td>
      <td>Australia</td>
      <td>PXH</td>
      <td>YPMH</td>
      <td>-29.716667</td>
      <td>135.521667</td>
      <td>734</td>
      <td>9.5</td>
      <td>O</td>
      <td>Australia/Adelaide</td>
    </tr>
    <tr>
      <th>8098</th>
      <td>8098</td>
      <td>9533</td>
      <td>Chatsworth Station</td>
      <td>Chatsworth</td>
      <td>United States</td>
      <td>CWT</td>
      <td>\N</td>
      <td>34.256944</td>
      <td>-118.598889</td>
      <td>978</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Los_Angeles</td>
    </tr>
    <tr>
      <th>8099</th>
      <td>8099</td>
      <td>9534</td>
      <td>Algerciras Port</td>
      <td>Algerciras</td>
      <td>Spain</td>
      <td>None</td>
      <td>\N</td>
      <td>36.136</td>
      <td>-5.435</td>
      <td>0</td>
      <td>1</td>
      <td>E</td>
      <td>Europe/Madrid</td>
    </tr>
    <tr>
      <th>8100</th>
      <td>8100</td>
      <td>9535</td>
      <td>Ganges Water Aerodrome</td>
      <td>Ganges</td>
      <td>Canada</td>
      <td>YGG</td>
      <td>\N</td>
      <td>48.85</td>
      <td>-123.5</td>
      <td>0</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Vancouver</td>
    </tr>
    <tr>
      <th>8101</th>
      <td>8101</td>
      <td>9536</td>
      <td>Pender Harbour Water Aerodrome</td>
      <td>Pender Harbour</td>
      <td>Canada</td>
      <td>YPT</td>
      <td>\N</td>
      <td>49.616667</td>
      <td>-124.016667</td>
      <td>0</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Vancouver</td>
    </tr>
    <tr>
      <th>8102</th>
      <td>8102</td>
      <td>9537</td>
      <td>Mansons Landing Water Aerodrome</td>
      <td>Mansons Landing</td>
      <td>Canada</td>
      <td>YMU</td>
      <td>\N</td>
      <td>50.066667</td>
      <td>-124.983333</td>
      <td>0</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Vancouver</td>
    </tr>
    <tr>
      <th>8103</th>
      <td>8103</td>
      <td>9538</td>
      <td>Port McNeill Airport</td>
      <td>Port McNeill</td>
      <td>Canada</td>
      <td>YMP</td>
      <td>\N</td>
      <td>50.575556</td>
      <td>-127.028611</td>
      <td>225</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Vancouver</td>
    </tr>
    <tr>
      <th>8104</th>
      <td>8104</td>
      <td>9539</td>
      <td>Sullivan Bay Water Aerodrome</td>
      <td>Sullivan Bay</td>
      <td>Canada</td>
      <td>YTG</td>
      <td>\N</td>
      <td>50.883333</td>
      <td>-126.833333</td>
      <td>0</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Vancouver</td>
    </tr>
    <tr>
      <th>8105</th>
      <td>8105</td>
      <td>9540</td>
      <td>Deer Harbor Seaplane</td>
      <td>Deer Harbor</td>
      <td>United States</td>
      <td>DHB</td>
      <td>\N</td>
      <td>48.618397</td>
      <td>-123.00596</td>
      <td>0</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Los_Angeles</td>
    </tr>
    <tr>
      <th>8106</th>
      <td>8106</td>
      <td>9541</td>
      <td>San Diego Old Town Transit Center</td>
      <td>San Diego</td>
      <td>United States</td>
      <td>OLT</td>
      <td>\N</td>
      <td>32.7552</td>
      <td>-117.1995</td>
      <td>0</td>
      <td>-8</td>
      <td>A</td>
      <td>America/Los_Angeles</td>
    </tr>
  </tbody>
</table>
<p>8107 rows × 13 columns</p>
</div>




```python
df_routes
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>airline</th>
      <th>airline_id</th>
      <th>source</th>
      <th>source_id</th>
      <th>dest</th>
      <th>dest_id</th>
      <th>codeshare</th>
      <th>stops</th>
      <th>equipment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2B</td>
      <td>410</td>
      <td>AER</td>
      <td>2965</td>
      <td>KZN</td>
      <td>2990</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2B</td>
      <td>410</td>
      <td>ASF</td>
      <td>2966</td>
      <td>KZN</td>
      <td>2990</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2B</td>
      <td>410</td>
      <td>ASF</td>
      <td>2966</td>
      <td>MRV</td>
      <td>2962</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2B</td>
      <td>410</td>
      <td>CEK</td>
      <td>2968</td>
      <td>KZN</td>
      <td>2990</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2B</td>
      <td>410</td>
      <td>CEK</td>
      <td>2968</td>
      <td>OVB</td>
      <td>4078</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>2B</td>
      <td>410</td>
      <td>DME</td>
      <td>4029</td>
      <td>KZN</td>
      <td>2990</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>2B</td>
      <td>410</td>
      <td>DME</td>
      <td>4029</td>
      <td>NBC</td>
      <td>6969</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>2B</td>
      <td>410</td>
      <td>DME</td>
      <td>4029</td>
      <td>TGK</td>
      <td>\N</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>2B</td>
      <td>410</td>
      <td>DME</td>
      <td>4029</td>
      <td>UUA</td>
      <td>6160</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>2B</td>
      <td>410</td>
      <td>EGO</td>
      <td>6156</td>
      <td>KGD</td>
      <td>2952</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>2B</td>
      <td>410</td>
      <td>EGO</td>
      <td>6156</td>
      <td>KZN</td>
      <td>2990</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>2B</td>
      <td>410</td>
      <td>GYD</td>
      <td>2922</td>
      <td>NBC</td>
      <td>6969</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>2B</td>
      <td>410</td>
      <td>KGD</td>
      <td>2952</td>
      <td>EGO</td>
      <td>6156</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
      <td>2B</td>
      <td>410</td>
      <td>KZN</td>
      <td>2990</td>
      <td>AER</td>
      <td>2965</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
      <td>2B</td>
      <td>410</td>
      <td>KZN</td>
      <td>2990</td>
      <td>ASF</td>
      <td>2966</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>2B</td>
      <td>410</td>
      <td>KZN</td>
      <td>2990</td>
      <td>CEK</td>
      <td>2968</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
      <td>2B</td>
      <td>410</td>
      <td>KZN</td>
      <td>2990</td>
      <td>DME</td>
      <td>4029</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
      <td>2B</td>
      <td>410</td>
      <td>KZN</td>
      <td>2990</td>
      <td>EGO</td>
      <td>6156</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
      <td>2B</td>
      <td>410</td>
      <td>KZN</td>
      <td>2990</td>
      <td>LED</td>
      <td>2948</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
      <td>2B</td>
      <td>410</td>
      <td>KZN</td>
      <td>2990</td>
      <td>SVX</td>
      <td>2975</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>20</th>
      <td>20</td>
      <td>2B</td>
      <td>410</td>
      <td>LED</td>
      <td>2948</td>
      <td>KZN</td>
      <td>2990</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>21</th>
      <td>21</td>
      <td>2B</td>
      <td>410</td>
      <td>LED</td>
      <td>2948</td>
      <td>NBC</td>
      <td>6969</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>22</th>
      <td>22</td>
      <td>2B</td>
      <td>410</td>
      <td>LED</td>
      <td>2948</td>
      <td>UUA</td>
      <td>6160</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>23</th>
      <td>23</td>
      <td>2B</td>
      <td>410</td>
      <td>MRV</td>
      <td>2962</td>
      <td>ASF</td>
      <td>2966</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>24</th>
      <td>24</td>
      <td>2B</td>
      <td>410</td>
      <td>NBC</td>
      <td>6969</td>
      <td>DME</td>
      <td>4029</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>25</th>
      <td>25</td>
      <td>2B</td>
      <td>410</td>
      <td>NBC</td>
      <td>6969</td>
      <td>GYD</td>
      <td>2922</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>26</th>
      <td>26</td>
      <td>2B</td>
      <td>410</td>
      <td>NBC</td>
      <td>6969</td>
      <td>LED</td>
      <td>2948</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>27</th>
      <td>27</td>
      <td>2B</td>
      <td>410</td>
      <td>NBC</td>
      <td>6969</td>
      <td>SVX</td>
      <td>2975</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>28</th>
      <td>28</td>
      <td>2B</td>
      <td>410</td>
      <td>NJC</td>
      <td>2972</td>
      <td>SVX</td>
      <td>2975</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>29</th>
      <td>29</td>
      <td>2B</td>
      <td>410</td>
      <td>NJC</td>
      <td>2972</td>
      <td>UUA</td>
      <td>6160</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>67633</th>
      <td>67633</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>ABX</td>
      <td>3333</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67634</th>
      <td>67634</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>ARM</td>
      <td>4062</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67635</th>
      <td>67635</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>BHQ</td>
      <td>6241</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67636</th>
      <td>67636</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>BHS</td>
      <td>6249</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67637</th>
      <td>67637</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>BNK</td>
      <td>4291</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67638</th>
      <td>67638</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>DBO</td>
      <td>3358</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67639</th>
      <td>67639</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>GFF</td>
      <td>6271</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67640</th>
      <td>67640</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>LSY</td>
      <td>6287</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67641</th>
      <td>67641</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>MIM</td>
      <td>6294</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67642</th>
      <td>67642</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>MQL</td>
      <td>6298</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67643</th>
      <td>67643</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>MYA</td>
      <td>6302</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67644</th>
      <td>67644</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>NRA</td>
      <td>6307</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67645</th>
      <td>67645</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>NTL</td>
      <td>4320</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67646</th>
      <td>67646</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>OAG</td>
      <td>6793</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67647</th>
      <td>67647</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>PKE</td>
      <td>6317</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67648</th>
      <td>67648</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>TRO</td>
      <td>6794</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67649</th>
      <td>67649</td>
      <td>ZL</td>
      <td>4178</td>
      <td>SYD</td>
      <td>3361</td>
      <td>WGA</td>
      <td>3363</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67650</th>
      <td>67650</td>
      <td>ZL</td>
      <td>4178</td>
      <td>TRO</td>
      <td>6794</td>
      <td>GFN</td>
      <td>6792</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67651</th>
      <td>67651</td>
      <td>ZL</td>
      <td>4178</td>
      <td>TRO</td>
      <td>6794</td>
      <td>SYD</td>
      <td>3361</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67652</th>
      <td>67652</td>
      <td>ZL</td>
      <td>4178</td>
      <td>TSV</td>
      <td>3330</td>
      <td>ISA</td>
      <td>3324</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67653</th>
      <td>67653</td>
      <td>ZL</td>
      <td>4178</td>
      <td>TSV</td>
      <td>3330</td>
      <td>WIN</td>
      <td>6337</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67654</th>
      <td>67654</td>
      <td>ZL</td>
      <td>4178</td>
      <td>WGA</td>
      <td>3363</td>
      <td>MEL</td>
      <td>3339</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67655</th>
      <td>67655</td>
      <td>ZL</td>
      <td>4178</td>
      <td>WGA</td>
      <td>3363</td>
      <td>SYD</td>
      <td>3361</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67656</th>
      <td>67656</td>
      <td>ZL</td>
      <td>4178</td>
      <td>WIN</td>
      <td>6337</td>
      <td>LRE</td>
      <td>6289</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67657</th>
      <td>67657</td>
      <td>ZL</td>
      <td>4178</td>
      <td>WIN</td>
      <td>6337</td>
      <td>TSV</td>
      <td>3330</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67658</th>
      <td>67658</td>
      <td>ZL</td>
      <td>4178</td>
      <td>WYA</td>
      <td>6334</td>
      <td>ADL</td>
      <td>3341</td>
      <td>None</td>
      <td>0</td>
      <td>SF3</td>
    </tr>
    <tr>
      <th>67659</th>
      <td>67659</td>
      <td>ZM</td>
      <td>19016</td>
      <td>DME</td>
      <td>4029</td>
      <td>FRU</td>
      <td>2912</td>
      <td>None</td>
      <td>0</td>
      <td>734</td>
    </tr>
    <tr>
      <th>67660</th>
      <td>67660</td>
      <td>ZM</td>
      <td>19016</td>
      <td>FRU</td>
      <td>2912</td>
      <td>DME</td>
      <td>4029</td>
      <td>None</td>
      <td>0</td>
      <td>734</td>
    </tr>
    <tr>
      <th>67661</th>
      <td>67661</td>
      <td>ZM</td>
      <td>19016</td>
      <td>FRU</td>
      <td>2912</td>
      <td>OSS</td>
      <td>2913</td>
      <td>None</td>
      <td>0</td>
      <td>734</td>
    </tr>
    <tr>
      <th>67662</th>
      <td>67662</td>
      <td>ZM</td>
      <td>19016</td>
      <td>OSS</td>
      <td>2913</td>
      <td>FRU</td>
      <td>2912</td>
      <td>None</td>
      <td>0</td>
      <td>734</td>
    </tr>
  </tbody>
</table>
<p>67663 rows × 10 columns</p>
</div>



### XLS persistence
- DataFrame의 엑셀 추출 코드
- XLS 엔진으로 openpyxls 또는 XlsxWrite 사용


```python
writer = pd.ExcelWriter('.data/df_routes.xlsx', engine = 'xlsxwriter')
df_routes.to_excel(writer, sheet_name = 'Sheet1')
```

### Pickle persistence
- 가장 일반적인 Python 파일 persistence
- to_pickle, read_pickle 함수 사용


```python
df_routes.to_pickle('./data/df_routes.pickle')
```


```python
df_routes_pickle = pd.read_pickle("./data/df_routes.pickle")
df_routes_pickle.head()
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>airline</th>
      <th>airline_id</th>
      <th>source</th>
      <th>source_id</th>
      <th>dest</th>
      <th>dest_id</th>
      <th>codeshare</th>
      <th>stops</th>
      <th>equipment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2B</td>
      <td>410</td>
      <td>AER</td>
      <td>2965</td>
      <td>KZN</td>
      <td>2990</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2B</td>
      <td>410</td>
      <td>ASF</td>
      <td>2966</td>
      <td>KZN</td>
      <td>2990</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2B</td>
      <td>410</td>
      <td>ASF</td>
      <td>2966</td>
      <td>MRV</td>
      <td>2962</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2B</td>
      <td>410</td>
      <td>CEK</td>
      <td>2968</td>
      <td>KZN</td>
      <td>2990</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2B</td>
      <td>410</td>
      <td>CEK</td>
      <td>2968</td>
      <td>OVB</td>
      <td>4078</td>
      <td>None</td>
      <td>0</td>
      <td>CR2</td>
    </tr>
  </tbody>
</table>
</div>
